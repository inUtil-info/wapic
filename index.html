<!DOCTYPE html>
<html>
  <head>
    <title>Formulario Dinámico</title>
    <script>
      function onSubmit() {
        // Get form data
        var token = document.getElementById("token").value;
        var phone = document.getElementById("phone").value;

        // Make API call
        fetch(`https://whatsapp-scraper.p.rapidapi.com/free/wspicture?phone=${phone}&token=${token}`, {
          headers: {
            "Content-Type": "application/octet-stream",
            "X-RapidAPI-Key": "0b2157bfc4mshe1bc5572ac284d7p17fde2jsnadff8abf693a",
            "X-RapidAPI-Host": "whatsapp-scraper.p.rapidapi.com",
          },
        })
          .then((response) => response.text())
          .then((html) => {
            // Parse HTML response
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, "text/html");

            // Get image from HTML
            const imgSrc = doc.querySelector(".msg-img img").getAttribute("src");

            // Hide form and show image
            document.getElementById("form").style.display = "none";
            const imgDiv = document.createElement("div");
            imgDiv.id = "image";
            document.body.appendChild(imgDiv);
            const img = document.createElement("img");
            img.onload = function () {
              imgDiv.appendChild(img);
            };
            img.src = imgSrc;
          })
          .catch((error) => {
            console.log(error);
            alert("Error: " + error.message);
          });
      }
    </script>
  </head>
  <body>
    <div id="form">
      <h2>Formulario Dinámico</h2>
      <form>
        <label for="token">Token:</label>
        <input type="text" id="token" name="token" required><br><br>
        <button type="button" onclick="document.getElementById('page2').style.display='block'">Siguiente</button>
      </form>
      <div id="page2" style="display:none;">
        <form>
          <label for="phone">Teléfono:</label>
          <input type="tel" id="phone" name="phone" required><br><br>
          <button type="button" onclick="onSubmit()">Enviar</button>
        </form>
      </div>
    </div>
  </body>
</html>
